tokens:
  env:
    proxyUri: ""
    noProxy: ""

testing:
  aktoApiSecurityTesting:
    env:
      aktoAccountName: Helios
      aktoConfigName: staging
      newTestingEnabled: "true"
      kafkaBrokerUrl: localhost:29092
      puppeteerReplayServiceUrl: http://localhost:3000
      databaseAbstractorUrl: https://cyborg.akto.io
      # If you want to use secrets to store database abstractor token. default: false
      useSecretsForDatabaseAbstractorToken: false
      # If not using secrets, place token here.
      databaseAbstractorToken: ""
      # If using secrets, place token here.
      databaseAbstractorTokenSecrets: 
        # Name of an existing secret containing the Database Abstractor Token
        existingSecret: ""
        # Token to use if existingSecret is not provided
        token: ""
      blockLogs: "false"
      aktoLogLevel: WARN
      miniTestingName: System-auto-scaled-akto-mini-testing

    image:
      repository: public.ecr.aws/aktosecurity/akto-api-security-mini-testing
      tag: 1.59.3_local
    imagePullPolicy: Always
    resources:
      requests:
        cpu: "200m"
        memory: "500Mi"
      limits:
        cpu: 2
        memory: "8Gi"

  prometheusServer:
    name: prometheus # name of port defined in the service/container
    port: 9400
    protocol: TCP
    metricsEndpoint:
      path: /metrics

  # Configuration for in-cluster Prometheus (default)
  kubePrometheus:
    enabled: true  # Set to false when using Grafana Cloud
    serviceName: prometheus-kube-prometheus-prometheus
    namespace: ""  # Leave empty to use same namespace as release
    port: 9090
    scrape:
      interval: 15s
      timeout: 10s

  # Configuration for Grafana Cloud (external Prometheus)
  # Set kubePrometheus.enabled=false when using this
  # Requires grafana-cloud-setup chart to be installed first
  grafanaCloud:
    enabled: false
    # Prometheus query endpoint (for KEDA to read metrics)
    queryUrl: ""  # e.g., https://prometheus-prod-43-prod-ap-south-1.grafana.net/api/prom
    # Username/Instance ID
    username: ""  # e.g., 2781763
    # API token for KEDA to query metrics (set via --set for security)
    readToken: ""
    # Secret name containing the read token
    secretName: grafana-cloud-tokens

  replicas: 1
  autoScaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 10
    customMetrics:
      type: prometheus
      pollingInterval: 30
      cooldownPeriod: 300
      isModuleBusy:
        metricName: is_module_busy
        trigger:
          name: is_module_busy_avg
          target: 0.9
          type: Value

  aktoApiSecurityPuppeteerReplay:
    image:
      repository: public.ecr.aws/aktosecurity/akto-puppeteer-replay
      tag: 1.48.0_latest
    imagePullPolicy: Always
    resources:
      requests:
        cpu: 1
        memory: "2Gi"
      limits:
        cpu: 1
        memory: "4Gi"

  kafka1:
    env:
      kafkaBrokerId: "1"
      kafkaCleanupPolicy: delete
      kafkaCreateTopics: akto.test.messages:1:1
      kafkaInterBrokerListenerName: LISTENER_DOCKER_EXTERNAL_LOCALHOST
      kafkaListenerSecurityProtocolMap: LISTENER_DOCKER_EXTERNAL_LOCALHOST:PLAINTEXT,
        LISTENER_DOCKER_EXTERNAL_DIFFHOST:PLAINTEXT
      kafkaLogCleanerEnable: "true"
      kafkaLogRetentionBytes: "10737418240"
      kafkaLogRetentionCheckIntervalMs: "60000"
      kafkaLogRetentionHours: "5"
      kafkaLogSegmentBytes: "104857600"
      kafkaOffsetsTopicReplicationFactor: "1"
      kafkaTransactionStateLogMinIsr: "1"
      kafkaTransactionStateLogReplicationFactor: "1"
      kafkaZookeeperConnect: 127.0.0.1:2181
    image:
      repository: public.ecr.aws/aktosecurity/confluentinc-cp-kafka
      tag: 7.8.0-3-ubi8
    resources:
      requests:
        cpu: 1
        memory: "2Gi"
      limits:
        cpu: 2
        memory: "4Gi"
  ports:
  - port: 9092
    targetPort: 9092
  type: ClusterIP
  zoo1:
    env:
      kafkaOpts: -Dzookeeper.admin.enableServer=false
      zookeeperClientPort: "2181"
      zookeeperServerId: "1"
      zookeeperServers: zoo1:2888:3888
    image:
      repository: public.ecr.aws/aktosecurity/confluentinc-cp-zookeeper
      tag: 7.8.0-3-ubi8
    resources:
      requests:
        cpu: 1
        memory: "2Gi"
      limits:
        cpu: 1
        memory: "2Gi"

keel:
  keel:
    env:
      awsAccessKeyId: ""
      awsRegion: ""
      awsSecretAccessKey: ""
      hipchatApprovalsBotName: ""
      hipchatApprovalsChannel: ""
      hipchatApprovalsPasswort: ""
      hipchatApprovalsUserName: ""
      hipchatChannels: ""
      hipchatToken: ""
      insecureRegistry: "true"
      mattermostEndpoint: ""
      notificationLevel: info
      webhookEndpoint: ""
    image:
      repository: public.ecr.aws/aktosecurity/keelhq-keel
      tag: akto_v1.0.0
    imagePullPolicy: Always
    resources:
      limits:
        cpu: 100m
        memory: 128Mi
      requests:
        cpu: 50m
        memory: 64Mi
    enabled: true
  maxUnavailable: 1
  ports:
  - name: keel
    port: 9300
    protocol: TCP
    targetPort: 9300
  replicas: 1
  serviceAccount:
    annotations: {}
  type: LoadBalancer
kubernetesClusterDomain: cluster.local
